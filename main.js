!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_error",errorClass:"modal__error_visible"},r=(e,t,r)=>{const o=e.querySelector(`#${t.id}-error`);t.classList.remove(r.inputErrorClass),o.textContent=""},o=(e,t)=>{e.classList.add(t.inactiveButtonClass),e.setAttribute("disabled",!0)},n=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?o(t,r):(t.removeAttribute("disabled"),t.classList.remove(r.inactiveButtonClass))};function a(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Save",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Saving...";e.textContent=t?o:r}function s(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...";t.preventDefault();const o=t.submitter,n=o.textContent;a(o,!0,n,r),e().then((()=>{t.target.reset()})).catch(console.error).finally((()=>{a(o,!1,n)}))}var l=e+"80804e27ce061efd1ffb.svg",c=e+"2fc47fd8e9a9bcd9612f.jpg",d=e+"3f562ce83766a824571e.svg",i=e+"d73f076c46eb5467f5fc.svg",u=e+"975792ea68af0a3c209d.svg";document.getElementById("logoSpots").src=l,document.getElementById("pencilImage").src=d,document.getElementById("avatarPencil").src=i,document.getElementById("plusIcon").src=u,document.getElementById("bessieAvatar").src=c;const m=document.querySelector("#edit-profile-modal"),_=document.querySelector(".profile__edit-btn"),v=document.querySelector(".profile__add-btn"),f=document.querySelector(".profile__avatar-btn"),h=document.querySelector(".profile__name"),p=document.querySelector(".profile__description"),y=document.querySelector(".profile__avatar"),S=m.querySelector(".modal__form"),b=m.querySelector(".modal__close"),g=m.querySelector("#profile-name-input"),q=m.querySelector("#profile-description-input"),L=document.querySelector("#add-card-modal"),E=L.querySelector(".modal__close"),k=L.querySelector(".modal__form"),C=L.querySelector(".modal__submit-btn"),I=(L.querySelector(".modal__submit-btn_disabled"),L.querySelector("#add-card-name-input")),A=L.querySelector("#add-card-link-input"),U=document.querySelector("#avatar-modal"),x=U.querySelector(".modal__close"),D=U.querySelector(".modal__form"),$=(U.querySelector(".modal__submit-btn"),U.querySelector("#profile-avatar-input")),B=document.querySelector("#delete-modal"),R=B.querySelector(".card__delete-form"),T=B.querySelector(".card__delete-form_close"),w=B.querySelector(".card__submit-btn_cancel"),P=document.querySelector("#preview-modal"),N=P.querySelector(".modal__image"),j=P.querySelector(".modal__caption"),O=P.querySelector(".modal__close_preview"),J=document.querySelector("#card-template"),G=document.querySelector(".cards__list");let H,z;I.addEventListener("input",t),A.addEventListener("input",t);const M=new class{constructor(e){let{baseURL:t,headers:r}=e;this._baseURL=t,this._headers=r}_checkresponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t){return fetch(e,t).then(this._checkresponse)}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return this._request(`${this._baseURL}/cards`,{method:"GET",headers:this._headers})}getUserInfo(){return this._request(`${this._baseURL}/users/me`,{method:"GET",headers:this._headers})}editUserInfo(e){let{name:t,about:r}=e;return this._request(`${this._baseURL}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})})}editAvatarInfo(e){return this._request(`${this._baseURL}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}addNewCard(e){let{name:t,link:r}=e;return this._request(`${this._baseURL}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})})}deleteCard(e){return this._request(`${this._baseURL}/cards/${e}`,{method:"DELETE",headers:this._headers})}handleLikeStatus(e,t){return this._request(`${this._baseURL}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers})}}({baseURL:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"ae624f98-22e3-40e2-ad55-6bf11082a736","Content-Type":"application/json"}});function F(e){const t=J.content.cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-btn"),a=t.querySelector(".card__delete-btn");return e.isLiked&&n.classList.add("card__like-btn_liked"),r.textContent=e.name,o.src=e.link,o.alt=e.name,n.addEventListener("click",(t=>function(e,t){e.preventDefault();const r=!!e.target.closest(".card__like-btn_liked"),o=e.target.closest(".card__like-btn");M.handleLikeStatus(t,r).then((()=>{r?o.classList.remove("card__like-btn_liked"):o.classList.add("card__like-btn_liked")})).catch(console.error)}(t,e._id))),console.log(e._id),a.addEventListener("click",(t=>function(e,t){H=e.target.closest(".card"),z=t,console.log(t),V(B)}(t,e._id))),o.addEventListener("click",(()=>function(e){N.src=e.link,j.textContent=e.name,N.alt=e.name,V(P)}(e))),t}function K(e){"Escape"===e.key&&W(document.querySelector(".modal_opened"))}function Q(e){e.target.classList.contains("modal_opened")&&W(e.target)}function V(e){e.classList.add("modal_opened"),e.addEventListener("click",Q),document.addEventListener("keydown",K)}function W(e){e.classList.remove("modal_opened"),e.removeEventListener("click",Q),document.removeEventListener("keydown",K)}var X;M.getAppInfo().then((e=>{let[t,{name:r,about:o,avatar:n}]=e;console.log(t),t.forEach((e=>{const t=F(e);G.append(t)})),h.textContent=r,p.textContent=o,y.src=n})).catch(console.error),console.log("API instance created:",M),console.log("getAppInfo method exists:",typeof M.getAppInfo),_.addEventListener("click",(()=>{var e,o;g.value=h.textContent,q.value=p.textContent,e=S,o=t,[g,q].forEach((t=>{r(e,t,o)})),V(m)})),b.addEventListener("click",(()=>{W(m)})),v.addEventListener("click",(()=>{V(L)})),f.addEventListener("click",(()=>{V(U)})),D.addEventListener("submit",(function(e){e.preventDefault(),console.log($.value),M.editAvatarInfo($.value).then((e=>{console.log(e),y.src=e.avatar,W(U)})).catch(console.error)})),x.addEventListener("click",(()=>{W(U)})),T.addEventListener("click",(()=>{W(B)})),R.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;a(t,!0,"Delete","Deleting..."),console.log("selectedCard:",H),console.log("Type of selectedCard:",typeof H),console.log(z),console.log("About to delete card with ID:",z),M.deleteCard(z).then((()=>{H.remove(),W(B)})).catch(console.error).finally((()=>{a(t,!1,"Delete","Deleting...")}))})),E.addEventListener("click",(()=>{W(L)})),O.addEventListener("click",(()=>{W(P)})),w.addEventListener("click",(()=>{W(B)})),S.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;a(t,!0,"Save","Saving..."),M.editUserInfo({name:g.value,about:q.value}).then((e=>{h.textContent=e.name,p.textContent=e.about,W(m),o(C,s)})).catch(console.error).finally((()=>{a(t,!1,"Save","Saving...")}))})),k.addEventListener("submit",(function(e){e.preventDefault(),s((function(){const t={name:I.value,link:A.value};return a(e.submitter,!0,"Save","Saving..."),M.addNewCard(t).then((t=>{const r=F(t);G.prepend(r),W(L),e.target.reset(),o(C,s)}))}),e)})),X=t,Array.from(document.querySelectorAll(X.formSelector)).forEach((e=>{((e,t)=>{const o=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);n(o,a,t),o.forEach((s=>{s.addEventListener("input",(function(){((e,t,o)=>{t.validity.valid?r(e,t,o):((e,t,r,o)=>{console.log(e);const n=e.querySelector(`#${t.id}-error`);t.classList.add(o.inputErrorClass),n.textContent=r})(e,t,t.validationMessage,o)})(e,s,t),n(o,a,t)}))}))})(e,X)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SyxFQUFRQyxFQUFTQyxLQUN0Q0QsRUFBUWUsU0FBU0MsTUFHcEJsQixFQUFlQyxFQUFRQyxFQUFTQyxHQWhCYitKLEVBQUNqSyxFQUFRQyxFQUFTaUssRUFBVWhLLEtBQ2pEb0MsUUFBUWtHLElBQUl4SSxHQUNaLE1BQU1HLEVBQWFILEVBQU9JLGNBQWMsSUFBSUgsRUFBUUksWUFDcERKLEVBQVFLLFVBQVVLLElBQUlULEVBQU9MLGlCQUM3Qk0sRUFBV0ssWUFBYzBKLENBQVEsRUFVL0JELENBQWVqSyxFQUFRQyxFQUFTQSxFQUFRa0ssa0JBQW1CakssRUFHN0QsRUFpQ0k4SixDQUFtQmhLLEVBQVFDLEVBQVNDLEdBQ3BDVyxFQUFrQkMsRUFBV0osRUFBV1IsRUFDMUMsR0FBRSxHQUNGLEVBS0E2SixDQUFrQi9KLEVBQVFFLEVBQU8sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9BcGkuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJleHBvcnQgY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnRuXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ0bl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcblxyXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGVycm9yTXNnLCBjb25maWcpID0+IHtcclxuICBjb25zb2xlLmxvZyhmb3JtRWwpO1xyXG4gIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IGVycm9yTXNnO1xyXG59O1xyXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbn07XHJcblxyXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcclxuICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgIHNob3dJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSwgY29uZmlnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcclxuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWwpID0+IHtcclxuICAgIHJldHVybiAhaW5wdXRFbC52YWxpZGl0eS52YWxpZDtcclxuICB9KTtcclxufTtcclxuZXhwb3J0IGNvbnN0IGRpc2FibGVCdXR0b24gPSAoc3VibWl0QnRuLCBjb25maWcpID0+IHtcclxuICBzdWJtaXRCdG4uY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgc3VibWl0QnRuLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIHRydWUpO1xyXG59O1xyXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIHN1Ym1pdEJ0biwgY29uZmlnKSA9PiB7XHJcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcbiAgICBkaXNhYmxlQnV0dG9uKHN1Ym1pdEJ0biwgY29uZmlnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgc3VibWl0QnRuLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xyXG4gICAgc3VibWl0QnRuLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH1cclxufTtcclxuZXhwb3J0IGNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWwsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKTtcclxuICB9KTtcclxufTtcclxuXHJcbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbCwgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWwucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcikpO1xyXG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBzdWJtaXRCdG4sIGNvbmZpZyk7XHJcblxyXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWwsIGlucHV0RWwsIGNvbmZpZyk7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgc3VibWl0QnRuLCBjb25maWcpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWwpID0+IHtcclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbCwgY29uZmlnKTtcclxuICB9KTtcclxufTtcclxuIiwiZXhwb3J0IGZ1bmN0aW9uIHNldEJ0blRleHQoXHJcbiAgYnRuLFxyXG4gIGlzTG9hZGluZyxcclxuICBkZWZhdWx0VGV4dCA9IFwiU2F2ZVwiLFxyXG4gIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIlxyXG4pIHtcclxuICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICBidG4udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICB9IGVsc2Uge1xyXG4gICAgYnRuLnRleHRDb250ZW50ID0gZGVmYXVsdFRleHQ7XHJcbiAgfVxyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVTdWJtaXQocmVxdWVzdCwgZXZ0LCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBjb25zdCBzdWJtaXRCdG4gPSBldnQuc3VibWl0dGVyO1xyXG4gIGNvbnN0IGluaXRpYWxUZXh0ID0gc3VibWl0QnRuLnRleHRDb250ZW50O1xyXG4gIHNldEJ0blRleHQoc3VibWl0QnRuLCB0cnVlLCBpbml0aWFsVGV4dCwgbG9hZGluZ1RleHQpO1xyXG4gIHJlcXVlc3QoKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBldnQudGFyZ2V0LnJlc2V0KCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHNldEJ0blRleHQoc3VibWl0QnRuLCBmYWxzZSwgaW5pdGlhbFRleHQpO1xyXG4gICAgfSk7XHJcbn1cclxuIiwiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVUkwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVSTCA9IGJhc2VVUkw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcbiAgX2NoZWNrcmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuICBfcmVxdWVzdCh1cmwsIG9wdGlvbnMpIHtcclxuICAgIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4odGhpcy5fY2hlY2tyZXNwb25zZSk7XHJcbiAgfVxyXG4gIGdldEFwcEluZm8oKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVSTH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVVJMfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVVJMfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGFib3V0LFxyXG4gICAgICB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuICBlZGl0QXZhdGFySW5mbyhhdmF0YXIpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVUkx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXIsXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGFkZE5ld0NhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVUkx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVSTH0vY2FyZHMvJHtpZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlTGlrZVN0YXR1cyhpZCwgaXNMaWtlZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVSTH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBBcGk7XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7XHJcbiAgZW5hYmxlVmFsaWRhdGlvbixcclxuICByZXNldFZhbGlkYXRpb24sXHJcbiAgdmFsaWRhdGlvbkNvbmZpZyxcclxuICBkaXNhYmxlQnV0dG9uLFxyXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcclxuaW1wb3J0IHsgc2V0QnRuVGV4dCwgaGFuZGxlU3VibWl0IH0gZnJvbSBcIi4uL3V0aWxzL2hlbHBlcnMuanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XHJcbmltcG9ydCBsb2dvU3BvdHMgZnJvbSBcIi4uL2ltYWdlcy9sb2dvLnN2Z1wiO1xyXG5pbXBvcnQgYmVzc2llQXZhdGFyIGZyb20gXCIuLi9pbWFnZXMvYXZhdGFyLmpwZ1wiO1xyXG5pbXBvcnQgcGVuY2lsSW1hZ2UgZnJvbSBcIi4uL2ltYWdlcy9wZW5jaWwuc3ZnXCI7XHJcbmltcG9ydCBhdmF0YXJQZW5jaWwgZnJvbSBcIi4uL2ltYWdlcy9wZW5jaWwtbGlnaHQuc3ZnXCI7XHJcbmltcG9ydCBwbHVzSWNvbiBmcm9tIFwiLi4vaW1hZ2VzL3BsdXMuc3ZnXCI7XHJcbmNvbnN0IHNwb3RzSW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvZ29TcG90c1wiKTtcclxuc3BvdHNJbWFnZS5zcmMgPSBsb2dvU3BvdHM7XHJcbmNvbnN0IHBlbmNpbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGVuY2lsSW1hZ2VcIik7XHJcbnBlbmNpbC5zcmMgPSBwZW5jaWxJbWFnZTtcclxuY29uc3QgbGlnaHRQZW5jaWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImF2YXRhclBlbmNpbFwiKTtcclxubGlnaHRQZW5jaWwuc3JjID0gYXZhdGFyUGVuY2lsO1xyXG5jb25zdCBhZGRJbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGx1c0ljb25cIik7XHJcbmFkZEltYWdlLnNyYyA9IHBsdXNJY29uO1xyXG5jb25zdCBiZXNzaWVJbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmVzc2llQXZhdGFyXCIpO1xyXG5iZXNzaWVJbWFnZS5zcmMgPSBiZXNzaWVBdmF0YXI7XHJcblxyXG5jb25zdCBlZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnRuXCIpO1xyXG5jb25zdCBjYXJkTW9kYWxCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idG5cIik7XHJcbmNvbnN0IGF2YXRhck1vZGFsQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnRuXCIpO1xyXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcclxuY29uc3QgcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xyXG5cclxuY29uc3QgZWRpdEZvcm1FbGVtZW50ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcblxyXG5jb25zdCBlZGl0TW9kYWxDbG9zZUJ0biA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuY29uc3QgZWRpdE1vZGFsTmFtZUlucHV0ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1uYW1lLWlucHV0XCIpO1xyXG5jb25zdCBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXHJcbik7XHJcblxyXG5jb25zdCBjYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsXCIpO1xyXG5cclxuY29uc3QgY2FyZE1vZGFsQ2xvc2VCdG4gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcbmNvbnN0IGNhcmRGb3JtID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmNvbnN0IGNhcmRTdWJtaXRCdG4gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ0blwiKTtcclxuY29uc3QgZGlzYWJsZWRCdG5FbCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnRuX2Rpc2FibGVkXCIpO1xyXG5jb25zdCBjYXJkTmFtZUlucHV0ID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbmFtZS1pbnB1dFwiKTtcclxuY29uc3QgY2FyZExpbmtJbnB1dCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWxpbmstaW5wdXRcIik7XHJcblxyXG4vL0F2YXRhciBmb3JtIGVsZW1lbnRzXHJcbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWxcIik7XHJcbmNvbnN0IGF2YXRhck1vZGFsQ2xvc2VCdG4gPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuY29uc3QgYXZhdGFyRm9ybSA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmNvbnN0IGF2YXRhclN1Ym1pdEJ0biA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idG5cIik7XHJcbmNvbnN0IGF2YXRhcklucHV0ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWF2YXRhci1pbnB1dFwiKTtcclxuXHJcbi8vRGVsZXRlIEZvcm0gRWxlbWVudHNcclxuY29uc3QgZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1tb2RhbFwiKTtcclxuY29uc3QgZGVsZXRlRm9ybSA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWZvcm1cIik7XHJcbmNvbnN0IGRlbGV0ZUZvcm1DbG9zZUJ0biA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIuY2FyZF9fZGVsZXRlLWZvcm1fY2xvc2VcIlxyXG4pO1xyXG5jb25zdCBjYW5jZWxEZWxldGVCdG4gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3N1Ym1pdC1idG5fY2FuY2VsXCIpO1xyXG5cclxuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxJbWdFbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcclxuY29uc3QgcHJldmlld01vZGFsQ2FwdGlvbkVsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XHJcbmNvbnN0IHByZXZpZXdDbG9zZUJ0biA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZV9wcmV2aWV3XCIpO1xyXG5cclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpO1xyXG5jb25zdCBjYXJkTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcblxyXG5sZXQgc2VsZWN0ZWRDYXJkO1xyXG5sZXQgc2VsZWN0ZWRDYXJkSWQ7XHJcblxyXG5jYXJkTmFtZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuY2FyZExpbmtJbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVVJMOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJhZTYyNGY5OC0yMmUzLTQwZTItYWQ1NS02YmYxMTA4MmE3MzZcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgY29uc3QgY2FyZE5hbWVFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgY29uc3QgY2FyZEltYWdlRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gIGNvbnN0IGNhcmRMaWtlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ0blwiKTtcclxuICBjb25zdCBjYXJkRGVsZXRlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnRuXCIpO1xyXG5cclxuICBpZiAoZGF0YS5pc0xpa2VkKSB7XHJcbiAgICBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIik7XHJcbiAgfVxyXG5cclxuICBjYXJkTmFtZUVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gIGNhcmRJbWFnZUVsLnNyYyA9IGRhdGEubGluaztcclxuICBjYXJkSW1hZ2VFbC5hbHQgPSBkYXRhLm5hbWU7XHJcblxyXG4gIGNhcmRMaWtlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiBoYW5kbGVMaWtlKGV2dCwgZGF0YS5faWQpKTtcclxuICBjb25zb2xlLmxvZyhkYXRhLl9pZCk7XHJcbiAgY2FyZERlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT5cclxuICAgIGhhbmRsZURlbGV0ZUNhcmQoZXZ0LCBkYXRhLl9pZClcclxuICApO1xyXG4gIGNhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBoYW5kbGVJbWFnZUNsaWNrKGRhdGEpKTtcclxuXHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG59XHJcblxyXG5hcGlcclxuICAuZ2V0QXBwSW5mbygpXHJcbiAgLnRoZW4oKFtjYXJkcywgeyBuYW1lLCBhYm91dCwgYXZhdGFyIH1dKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhjYXJkcyk7XHJcbiAgICBjYXJkcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoaXRlbSk7XHJcbiAgICAgIGNhcmRMaXN0LmFwcGVuZChjYXJkRWxlbWVudCk7XHJcbiAgICB9KTtcclxuICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGFib3V0O1xyXG4gICAgcHJvZmlsZUF2YXRhci5zcmMgPSBhdmF0YXI7XHJcbiAgfSlcclxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcblxyXG5jb25zb2xlLmxvZyhcIkFQSSBpbnN0YW5jZSBjcmVhdGVkOlwiLCBhcGkpO1xyXG5jb25zb2xlLmxvZyhcImdldEFwcEluZm8gbWV0aG9kIGV4aXN0czpcIiwgdHlwZW9mIGFwaS5nZXRBcHBJbmZvKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUVzY0Nsb3NlKGV2dCkge1xyXG4gIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICBjb25zdCBtb2RhbE9wZW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGNsb3NlTW9kYWwobW9kYWxPcGVuKTtcclxuICB9XHJcbn1cclxuZnVuY3Rpb24gaGFuZGxlQ2xpY2tPdXRzaWRlKGV2dCkge1xyXG4gIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xyXG4gICAgY2xvc2VNb2RhbChldnQudGFyZ2V0KTtcclxuICB9XHJcbn1cclxuZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQ2xpY2tPdXRzaWRlKTtcclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NDbG9zZSk7XHJcbn1cclxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgbW9kYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUNsaWNrT3V0c2lkZSk7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjQ2xvc2UpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFZGl0Rm9ybVN1Ym1pdChldnQpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBjb25zdCBzdWJtaXRCdG4gPSBldnQuc3VibWl0dGVyO1xyXG4gIHNldEJ0blRleHQoc3VibWl0QnRuLCB0cnVlLCBcIlNhdmVcIiwgXCJTYXZpbmcuLi5cIik7XHJcbiAgYXBpXHJcbiAgICAuZWRpdFVzZXJJbmZvKHtcclxuICAgICAgbmFtZTogZWRpdE1vZGFsTmFtZUlucHV0LnZhbHVlLFxyXG4gICAgICBhYm91dDogZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZSxcclxuICAgIH0pXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcclxuICAgICAgY2xvc2VNb2RhbChlZGl0TW9kYWwpO1xyXG4gICAgICBkaXNhYmxlQnV0dG9uKGNhcmRTdWJtaXRCdG4sIGhhbmRsZVN1Ym1pdCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHNldEJ0blRleHQoc3VibWl0QnRuLCBmYWxzZSwgXCJTYXZlXCIsIFwiU2F2aW5nLi4uXCIpO1xyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChldnQpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBmdW5jdGlvbiBtYWtlUmVxdWVzdCgpIHtcclxuICAgIGNvbnN0IGRhdGEgPSB7IG5hbWU6IGNhcmROYW1lSW5wdXQudmFsdWUsIGxpbms6IGNhcmRMaW5rSW5wdXQudmFsdWUgfTtcclxuICAgIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XHJcbiAgICBzZXRCdG5UZXh0KHN1Ym1pdEJ0biwgdHJ1ZSwgXCJTYXZlXCIsIFwiU2F2aW5nLi4uXCIpO1xyXG4gICAgcmV0dXJuIGFwaS5hZGROZXdDYXJkKGRhdGEpLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChkYXRhKTtcclxuICAgICAgY2FyZExpc3QucHJlcGVuZChjYXJkRWxlbWVudCk7XHJcbiAgICAgIGNsb3NlTW9kYWwoY2FyZE1vZGFsKTtcclxuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xyXG4gICAgICBkaXNhYmxlQnV0dG9uKGNhcmRTdWJtaXRCdG4sIGhhbmRsZVN1Ym1pdCk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBldnQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJTdWJtaXQoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc29sZS5sb2coYXZhdGFySW5wdXQudmFsdWUpO1xyXG4gIGFwaVxyXG4gICAgLmVkaXRBdmF0YXJJbmZvKGF2YXRhcklucHV0LnZhbHVlKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgIHByb2ZpbGVBdmF0YXIuc3JjID0gZGF0YS5hdmF0YXI7XHJcbiAgICAgIGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChldnQsIGNhcmRJZCkge1xyXG4gIHNlbGVjdGVkQ2FyZCA9IGV2dC50YXJnZXQuY2xvc2VzdChcIi5jYXJkXCIpO1xyXG4gIHNlbGVjdGVkQ2FyZElkID0gY2FyZElkO1xyXG4gIGNvbnNvbGUubG9nKGNhcmRJZCk7XHJcbiAgb3Blbk1vZGFsKGRlbGV0ZU1vZGFsKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IGRlbGV0ZUJ0biA9IGV2dC5zdWJtaXR0ZXI7XHJcbiAgc2V0QnRuVGV4dChkZWxldGVCdG4sIHRydWUsIFwiRGVsZXRlXCIsIFwiRGVsZXRpbmcuLi5cIik7XHJcblxyXG4gIGNvbnNvbGUubG9nKFwic2VsZWN0ZWRDYXJkOlwiLCBzZWxlY3RlZENhcmQpO1xyXG4gIGNvbnNvbGUubG9nKFwiVHlwZSBvZiBzZWxlY3RlZENhcmQ6XCIsIHR5cGVvZiBzZWxlY3RlZENhcmQpO1xyXG4gIGNvbnNvbGUubG9nKHNlbGVjdGVkQ2FyZElkKTtcclxuICBjb25zb2xlLmxvZyhcIkFib3V0IHRvIGRlbGV0ZSBjYXJkIHdpdGggSUQ6XCIsIHNlbGVjdGVkQ2FyZElkKTtcclxuICBhcGlcclxuICAgIC5kZWxldGVDYXJkKHNlbGVjdGVkQ2FyZElkKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XHJcbiAgICAgIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBzZXRCdG5UZXh0KGRlbGV0ZUJ0biwgZmFsc2UsIFwiRGVsZXRlXCIsIFwiRGVsZXRpbmcuLi5cIik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTGlrZShldnQsIGlkKSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3QgaXNMaWtlZCA9ICEhZXZ0LnRhcmdldC5jbG9zZXN0KFwiLmNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpO1xyXG4gIGNvbnN0IGNhcmRMaWtlQnRuID0gZXZ0LnRhcmdldC5jbG9zZXN0KFwiLmNhcmRfX2xpa2UtYnRuXCIpO1xyXG4gIGFwaVxyXG4gICAgLmhhbmRsZUxpa2VTdGF0dXMoaWQsIGlzTGlrZWQpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIGlmICghaXNMaWtlZCkge1xyXG4gICAgICAgIGNhcmRMaWtlQnRuLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIik7XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2soZGF0YSkge1xyXG4gIHByZXZpZXdNb2RhbEltZ0VsLnNyYyA9IGRhdGEubGluaztcclxuICBwcmV2aWV3TW9kYWxDYXB0aW9uRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgcHJldmlld01vZGFsSW1nRWwuYWx0ID0gZGF0YS5uYW1lO1xyXG4gIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xyXG59XHJcblxyXG5wcm9maWxlRWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gIGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XHJcbiAgcmVzZXRWYWxpZGF0aW9uKFxyXG4gICAgZWRpdEZvcm1FbGVtZW50LFxyXG4gICAgW2VkaXRNb2RhbE5hbWVJbnB1dCwgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dF0sXHJcbiAgICB2YWxpZGF0aW9uQ29uZmlnXHJcbiAgKTtcclxuICBvcGVuTW9kYWwoZWRpdE1vZGFsKTtcclxufSk7XHJcblxyXG5lZGl0TW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwoZWRpdE1vZGFsKTtcclxufSk7XHJcblxyXG5jYXJkTW9kYWxCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBvcGVuTW9kYWwoY2FyZE1vZGFsKTtcclxufSk7XHJcblxyXG5hdmF0YXJNb2RhbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIG9wZW5Nb2RhbChhdmF0YXJNb2RhbCk7XHJcbn0pO1xyXG5hdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQXZhdGFyU3VibWl0KTtcclxuXHJcbmF2YXRhck1vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcclxufSk7XHJcblxyXG5kZWxldGVGb3JtQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcclxufSk7XHJcblxyXG5kZWxldGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRGVsZXRlU3VibWl0KTtcclxuY2FyZE1vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKGNhcmRNb2RhbCk7XHJcbn0pO1xyXG5cclxucHJldmlld0Nsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY2xvc2VNb2RhbChwcmV2aWV3TW9kYWwpO1xyXG59KTtcclxuXHJcbmNhbmNlbERlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG59KTtcclxuZWRpdEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRWRpdEZvcm1TdWJtaXQpO1xyXG5jYXJkRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUFkZENhcmRTdWJtaXQpO1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKTtcclxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJ2YWxpZGF0aW9uQ29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbCIsImlucHV0RWwiLCJjb25maWciLCJlcnJvck1zZ0VsIiwicXVlcnlTZWxlY3RvciIsImlkIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidGV4dENvbnRlbnQiLCJkaXNhYmxlQnV0dG9uIiwic3VibWl0QnRuIiwiYWRkIiwic2V0QXR0cmlidXRlIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsInJlbW92ZUF0dHJpYnV0ZSIsInNldEJ0blRleHQiLCJidG4iLCJpc0xvYWRpbmciLCJkZWZhdWx0VGV4dCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImxvYWRpbmdUZXh0IiwiaGFuZGxlU3VibWl0IiwicmVxdWVzdCIsImV2dCIsInByZXZlbnREZWZhdWx0Iiwic3VibWl0dGVyIiwiaW5pdGlhbFRleHQiLCJ0aGVuIiwidGFyZ2V0IiwicmVzZXQiLCJjYXRjaCIsImNvbnNvbGUiLCJlcnJvciIsImZpbmFsbHkiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwic3JjIiwibG9nb1Nwb3RzIiwicGVuY2lsSW1hZ2UiLCJhdmF0YXJQZW5jaWwiLCJwbHVzSWNvbiIsImJlc3NpZUF2YXRhciIsImVkaXRNb2RhbCIsInByb2ZpbGVFZGl0QnRuIiwiY2FyZE1vZGFsQnRuIiwiYXZhdGFyTW9kYWxCdG4iLCJwcm9maWxlTmFtZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsInByb2ZpbGVBdmF0YXIiLCJlZGl0Rm9ybUVsZW1lbnQiLCJlZGl0TW9kYWxDbG9zZUJ0biIsImVkaXRNb2RhbE5hbWVJbnB1dCIsImVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQiLCJjYXJkTW9kYWwiLCJjYXJkTW9kYWxDbG9zZUJ0biIsImNhcmRGb3JtIiwiY2FyZFN1Ym1pdEJ0biIsImNhcmROYW1lSW5wdXQiLCJjYXJkTGlua0lucHV0IiwiYXZhdGFyTW9kYWwiLCJhdmF0YXJNb2RhbENsb3NlQnRuIiwiYXZhdGFyRm9ybSIsImF2YXRhcklucHV0IiwiZGVsZXRlTW9kYWwiLCJkZWxldGVGb3JtIiwiZGVsZXRlRm9ybUNsb3NlQnRuIiwiY2FuY2VsRGVsZXRlQnRuIiwicHJldmlld01vZGFsIiwicHJldmlld01vZGFsSW1nRWwiLCJwcmV2aWV3TW9kYWxDYXB0aW9uRWwiLCJwcmV2aWV3Q2xvc2VCdG4iLCJjYXJkVGVtcGxhdGUiLCJjYXJkTGlzdCIsInNlbGVjdGVkQ2FyZCIsInNlbGVjdGVkQ2FyZElkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImFwaSIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImJhc2VVUkwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVVJMIiwiX2hlYWRlcnMiLCJfY2hlY2tyZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJfcmVxdWVzdCIsInVybCIsIm9wdGlvbnMiLCJmZXRjaCIsImdldEFwcEluZm8iLCJhbGwiLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VySW5mbyIsIm1ldGhvZCIsImVkaXRVc2VySW5mbyIsIl9yZWYyIiwibmFtZSIsImFib3V0IiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlZGl0QXZhdGFySW5mbyIsImF2YXRhciIsImFkZE5ld0NhcmQiLCJfcmVmMyIsImxpbmsiLCJkZWxldGVDYXJkIiwiaGFuZGxlTGlrZVN0YXR1cyIsImlzTGlrZWQiLCJhdXRob3JpemF0aW9uIiwiZ2V0Q2FyZEVsZW1lbnQiLCJkYXRhIiwiY2FyZEVsZW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZE5hbWVFbCIsImNhcmRJbWFnZUVsIiwiY2FyZExpa2VCdG4iLCJjYXJkRGVsZXRlQnRuIiwiYWx0IiwiY2xvc2VzdCIsImhhbmRsZUxpa2UiLCJfaWQiLCJsb2ciLCJjYXJkSWQiLCJvcGVuTW9kYWwiLCJoYW5kbGVEZWxldGVDYXJkIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZUVzY0Nsb3NlIiwia2V5IiwiY2xvc2VNb2RhbCIsImhhbmRsZUNsaWNrT3V0c2lkZSIsImNvbnRhaW5zIiwibW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiY2FyZHMiLCJmb3JFYWNoIiwiaXRlbSIsImFwcGVuZCIsInJlc2V0VmFsaWRhdGlvbiIsInZhbHVlIiwiZGVsZXRlQnRuIiwicHJlcGVuZCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJzZXRFdmVudExpc3RlbmVycyIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNc2ciLCJ2YWxpZGF0aW9uTWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=